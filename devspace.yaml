version: v1beta9
images:
  rest:
    image: pogowebbackendrest
    preferSyncOverRebuild: true
    injectRestartHelper: true
    appendDockerfileInstructions:
    - USER root
    cmd: [npm, run, start_rest]
  matchhandling:
    image: pogowebbackendmatchhandling
    preferSyncOverRebuild: true
    injectRestartHelper: true
    appendDockerfileInstructions:
    - USER root
    cmd: [npm, run, start_matchhandling]
deployments:
- name: pogo-web-backend-rest
  helm:
    componentChart: true
    values:
      containers:
      - image: pogowebbackendrest
      service:
        ports:
        - port: 2999
- name: pogo-web-backend-matchhandling
  helm:
    componentChart: true
    values:
      containers:
      - image: pogowebbackendmatchhandling
      service:
        ports:
        - port: 3000
- name: redis
  helm:
    componentChart: true
    values:
      containers:
      - image: redis
      service:
        ports:
        - port: 6379
dev:
  ports:
  - imageName: rest
    forward:
    - port: 2999
  - imageName: matchhandling
    forward:
    - port: 3000
  sync:
  - imageName: rest
    excludePaths:
    - .git/
    uploadExcludePaths:
    - Dockerfile
    - node_modules/
    - devspace.yaml
    onUpload:
      restartContainer: true
  - imageName: matchhandling
    excludePaths:
    - .git/
    uploadExcludePaths:
    - Dockerfile
    - node_modules/
    - devspace.yaml
    onUpload:
      restartContainer: true
profiles:
- name: production
  description: ""
  patches:
  - op: remove
    path: images.app.appendDockerfileInstructions
  - op: remove
    path: images.app.injectRestartHelper
- name: interactive
  description: ""
  patches:
  - op: add
    path: dev.interactive
    value:
      defaultEnabled: true
  - op: add
    path: images.app.entrypoint
    value:
    - sleep
    - "9999999999"
